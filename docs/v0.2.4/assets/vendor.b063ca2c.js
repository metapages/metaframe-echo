var K,g,zt,Zt,Y,Kt,Yt,Qt,ot={},Xt=[],pn=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function U(e,t){for(var n in t)e[n]=t[n];return e}function te(e){var t=e.parentNode;t&&t.removeChild(e)}function P(e,t,n){var i,r,s,o={};for(s in t)s=="key"?i=t[s]:s=="ref"?r=t[s]:o[s]=t[s];if(arguments.length>2&&(o.children=arguments.length>3?K.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(s in e.defaultProps)o[s]===void 0&&(o[s]=e.defaultProps[s]);return Q(e,o,i,r,null)}function Q(e,t,n,i,r){var s={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:r??++zt};return r==null&&g.vnode!=null&&g.vnode(s),s}function ee(){return{current:null}}function N(e){return e.children}function R(e,t){this.props=e,this.context=t}function q(e,t){if(t==null)return e.__?q(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?q(e):null}function ne(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return ne(e)}}function St(e){(!e.__d&&(e.__d=!0)&&Y.push(e)&&!ut.__r++||Yt!==g.debounceRendering)&&((Yt=g.debounceRendering)||Kt)(ut)}function ut(){for(var e;ut.__r=Y.length;)e=Y.sort(function(t,n){return t.__v.__b-n.__v.__b}),Y=[],e.some(function(t){var n,i,r,s,o,h;t.__d&&(o=(s=(n=t).__v).__e,(h=n.__P)&&(i=[],(r=U({},s)).__v=s.__v+1,It(h,s,r,n.__n,h.ownerSVGElement!==void 0,s.__h!=null?[o]:null,i,o??q(s),s.__h),he(i,s),s.__e!=o&&ne(s)))})}function ie(e,t,n,i,r,s,o,h,u,f){var a,l,c,p,_,m,d,v=i&&i.__k||Xt,b=v.length;for(n.__k=[],a=0;a<t.length;a++)if((p=n.__k[a]=(p=t[a])==null||typeof p=="boolean"?null:typeof p=="string"||typeof p=="number"||typeof p=="bigint"?Q(null,p,null,null,p):Array.isArray(p)?Q(N,{children:p},null,null,null):p.__b>0?Q(p.type,p.props,p.key,null,p.__v):p)!=null){if(p.__=n,p.__b=n.__b+1,(c=v[a])===null||c&&p.key==c.key&&p.type===c.type)v[a]=void 0;else for(l=0;l<b;l++){if((c=v[l])&&p.key==c.key&&p.type===c.type){v[l]=void 0;break}c=null}It(e,p,c=c||ot,r,s,o,h,u,f),_=p.__e,(l=p.ref)&&c.ref!=l&&(d||(d=[]),c.ref&&d.push(c.ref,null,p),d.push(l,p.__c||_,p)),_!=null?(m==null&&(m=_),typeof p.type=="function"&&p.__k===c.__k?p.__d=u=se(p,u,e):u=re(e,p,c,v,_,u),typeof n.type=="function"&&(n.__d=u)):u&&c.__e==u&&u.parentNode!=e&&(u=q(c))}for(n.__e=m,a=b;a--;)v[a]!=null&&(typeof n.type=="function"&&v[a].__e!=null&&v[a].__e==n.__d&&(n.__d=q(i,a+1)),le(v[a],v[a]));if(d)for(a=0;a<d.length;a++)fe(d[a],d[++a],d[++a])}function se(e,t,n){for(var i,r=e.__k,s=0;r&&s<r.length;s++)(i=r[s])&&(i.__=e,t=typeof i.type=="function"?se(i,t,n):re(n,i,i,r,i.__e,t));return t}function D(e,t){return t=t||[],e==null||typeof e=="boolean"||(Array.isArray(e)?e.some(function(n){D(n,t)}):t.push(e)),t}function re(e,t,n,i,r,s){var o,h,u;if(t.__d!==void 0)o=t.__d,t.__d=void 0;else if(n==null||r!=s||r.parentNode==null)t:if(s==null||s.parentNode!==e)e.appendChild(r),o=null;else{for(h=s,u=0;(h=h.nextSibling)&&u<i.length;u+=2)if(h==r)break t;e.insertBefore(r,s),o=s}return o!==void 0?o:r.nextSibling}function _n(e,t,n,i,r){var s;for(s in n)s==="children"||s==="key"||s in t||ht(e,s,null,n[s],i);for(s in t)r&&typeof t[s]!="function"||s==="children"||s==="key"||s==="value"||s==="checked"||n[s]===t[s]||ht(e,s,t[s],n[s],i)}function ae(e,t,n){t[0]==="-"?e.setProperty(t,n):e[t]=n==null?"":typeof n!="number"||pn.test(t)?n:n+"px"}function ht(e,t,n,i,r){var s;t:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof i=="string"&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||ae(e.style,t,"");if(n)for(t in n)i&&n[t]===i[t]||ae(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")s=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?i||e.addEventListener(t,s?ue:oe,s):e.removeEventListener(t,s?ue:oe,s);else if(t!=="dangerouslySetInnerHTML"){if(r)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=n??"";break t}catch{}typeof n=="function"||(n!=null&&(n!==!1||t[0]==="a"&&t[1]==="r")?e.setAttribute(t,n):e.removeAttribute(t))}}function oe(e){this.l[e.type+!1](g.event?g.event(e):e)}function ue(e){this.l[e.type+!0](g.event?g.event(e):e)}function It(e,t,n,i,r,s,o,h,u){var f,a,l,c,p,_,m,d,v,b,y,O=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(u=n.__h,h=t.__e=n.__e,t.__h=null,s=[h]),(f=g.__b)&&f(t);try{t:if(typeof O=="function"){if(d=t.props,v=(f=O.contextType)&&i[f.__c],b=f?v?v.props.value:f.__:i,n.__c?m=(a=t.__c=n.__c).__=a.__E:("prototype"in O&&O.prototype.render?t.__c=a=new O(d,b):(t.__c=a=new R(d,b),a.constructor=O,a.render=mn),v&&v.sub(a),a.props=d,a.state||(a.state={}),a.context=b,a.__n=i,l=a.__d=!0,a.__h=[]),a.__s==null&&(a.__s=a.state),O.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=U({},a.__s)),U(a.__s,O.getDerivedStateFromProps(d,a.__s))),c=a.props,p=a.state,l)O.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(O.getDerivedStateFromProps==null&&d!==c&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(d,b),!a.__e&&a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(d,a.__s,b)===!1||t.__v===n.__v){a.props=d,a.state=a.__s,t.__v!==n.__v&&(a.__d=!1),a.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(S){S&&(S.__=t)}),a.__h.length&&o.push(a);break t}a.componentWillUpdate!=null&&a.componentWillUpdate(d,a.__s,b),a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(c,p,_)})}a.context=b,a.props=d,a.state=a.__s,(f=g.__r)&&f(t),a.__d=!1,a.__v=t,a.__P=e,f=a.render(a.props,a.state,a.context),a.state=a.__s,a.getChildContext!=null&&(i=U(U({},i),a.getChildContext())),l||a.getSnapshotBeforeUpdate==null||(_=a.getSnapshotBeforeUpdate(c,p)),y=f!=null&&f.type===N&&f.key==null?f.props.children:f,ie(e,Array.isArray(y)?y:[y],t,n,i,r,s,o,h,u),a.base=t.__e,t.__h=null,a.__h.length&&o.push(a),m&&(a.__E=a.__=null),a.__e=!1}else s==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=dn(n.__e,t,n,i,r,s,o,u);(f=g.diffed)&&f(t)}catch(S){t.__v=null,(u||s!=null)&&(t.__e=h,t.__h=!!u,s[s.indexOf(h)]=null),g.__e(S,t,n)}}function he(e,t){g.__c&&g.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(i){i.call(n)})}catch(i){g.__e(i,n.__v)}})}function dn(e,t,n,i,r,s,o,h){var u,f,a,l=n.props,c=t.props,p=t.type,_=0;if(p==="svg"&&(r=!0),s!=null){for(;_<s.length;_++)if((u=s[_])&&(u===e||(p?u.localName==p:u.nodeType==3))){e=u,s[_]=null;break}}if(e==null){if(p===null)return document.createTextNode(c);e=r?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,c.is&&c),s=null,h=!1}if(p===null)l===c||h&&e.data===c||(e.data=c);else{if(s=s&&K.call(e.childNodes),f=(l=n.props||ot).dangerouslySetInnerHTML,a=c.dangerouslySetInnerHTML,!h){if(s!=null)for(l={},_=0;_<e.attributes.length;_++)l[e.attributes[_].name]=e.attributes[_].value;(a||f)&&(a&&(f&&a.__html==f.__html||a.__html===e.innerHTML)||(e.innerHTML=a&&a.__html||""))}if(_n(e,c,l,r,h),a)t.__k=[];else if(_=t.props.children,ie(e,Array.isArray(_)?_:[_],t,n,i,r&&p!=="foreignObject",s,o,s?s[0]:n.__k&&q(n,0),h),s!=null)for(_=s.length;_--;)s[_]!=null&&te(s[_]);h||("value"in c&&(_=c.value)!==void 0&&(_!==e.value||p==="progress"&&!_)&&ht(e,"value",_,l.value,!1),"checked"in c&&(_=c.checked)!==void 0&&_!==e.checked&&ht(e,"checked",_,l.checked,!1))}return e}function fe(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(i){g.__e(i,n)}}function le(e,t,n){var i,r;if(g.unmount&&g.unmount(e),(i=e.ref)&&(i.current&&i.current!==e.__e||fe(i,null,t)),(i=e.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(s){g.__e(s,t)}i.base=i.__P=null}if(i=e.__k)for(r=0;r<i.length;r++)i[r]&&le(i[r],t,typeof e.type!="function");n||e.__e==null||te(e.__e),e.__e=e.__d=void 0}function mn(e,t,n){return this.constructor(e,n)}function B(e,t,n){var i,r,s;g.__&&g.__(e,t),r=(i=typeof n=="function")?null:n&&n.__k||t.__k,s=[],It(t,e=(!i&&n||t).__k=P(N,null,[e]),r||ot,ot,t.ownerSVGElement!==void 0,!i&&n?[n]:r?null:t.firstChild?K.call(t.childNodes):null,s,!i&&n?n:r?r.__e:t.firstChild,i),he(s,e)}function Et(e,t){B(e,t,Et)}function ce(e,t,n){var i,r,s,o=U({},e.props);for(s in t)s=="key"?i=t[s]:s=="ref"?r=t[s]:o[s]=t[s];return arguments.length>2&&(o.children=arguments.length>3?K.call(arguments,2):n),Q(e.type,o,i||e.key,r||e.ref,null)}function ft(e,t){var n={__c:t="__cC"+Qt++,__:e,Consumer:function(i,r){return i.children(r)},Provider:function(i){var r,s;return this.getChildContext||(r=[],(s={})[t]=this,this.getChildContext=function(){return s},this.shouldComponentUpdate=function(o){this.props.value!==o.value&&r.some(St)},this.sub=function(o){r.push(o);var h=o.componentWillUnmount;o.componentWillUnmount=function(){r.splice(r.indexOf(o),1),h&&h.call(o)}}),i.children}};return n.Provider.__=n.Consumer.contextType=n}K=Xt.slice,g={__e:function(e,t){for(var n,i,r;t=t.__;)if((n=t.__c)&&!n.__)try{if((i=n.constructor)&&i.getDerivedStateFromError!=null&&(n.setState(i.getDerivedStateFromError(e)),r=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(e),r=n.__d),r)return n.__E=n}catch(s){e=s}throw e}},zt=0,Zt=function(e){return e!=null&&e.constructor===void 0},R.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=U({},this.state),typeof e=="function"&&(e=e(U({},n),this.props)),e&&U(n,e),e!=null&&this.__v&&(t&&this.__h.push(t),St(this))},R.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),St(this))},R.prototype.render=N,Y=[],Kt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ut.__r=0,Qt=0;var gn=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",render:B,hydrate:Et,createElement:P,h:P,Fragment:N,createRef:ee,get isValidElement(){return Zt},Component:R,cloneElement:ce,createContext:ft,toChildArray:D,get options(){return g}}),G,M,pe,J=0,Mt=[],_e=g.__b,de=g.__r,me=g.diffed,ge=g.__c,ve=g.unmount;function X(e,t){g.__h&&g.__h(M,e,J||t),J=0;var n=M.__H||(M.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function tt(e){return J=1,be(Se,e)}function be(e,t,n){var i=X(G++,2);return i.t=e,i.__c||(i.__=[n?n(t):Se(void 0,t),function(r){var s=i.t(i.__[0],r);i.__[0]!==s&&(i.__=[s,i.__[1]],i.__c.setState({}))}],i.__c=M),i.__}function et(e,t){var n=X(G++,3);!g.__s&&Rt(n.__H,t)&&(n.__=e,n.__H=t,M.__H.__h.push(n))}function ye(e,t){var n=X(G++,4);!g.__s&&Rt(n.__H,t)&&(n.__=e,n.__H=t,M.__h.push(n))}function vn(e){return J=5,kt(function(){return{current:e}},[])}function bn(e,t,n){J=6,ye(function(){typeof e=="function"?e(t()):e&&(e.current=t())},n==null?n:n.concat(e))}function kt(e,t){var n=X(G++,7);return Rt(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function $t(e,t){return J=8,kt(function(){return e},t)}function we(e){var t=M.context[e.__c],n=X(G++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(M)),t.props.value):e.__}function yn(e,t){g.useDebugValue&&g.useDebugValue(t?t(e):e)}function wn(){Mt.forEach(function(e){if(e.__P)try{e.__H.__h.forEach(lt),e.__H.__h.forEach(Pt),e.__H.__h=[]}catch(t){e.__H.__h=[],g.__e(t,e.__v)}}),Mt=[]}g.__b=function(e){M=null,_e&&_e(e)},g.__r=function(e){de&&de(e),G=0;var t=(M=e.__c).__H;t&&(t.__h.forEach(lt),t.__h.forEach(Pt),t.__h=[])},g.diffed=function(e){me&&me(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(Mt.push(t)!==1&&pe===g.requestAnimationFrame||((pe=g.requestAnimationFrame)||function(n){var i,r=function(){clearTimeout(s),Oe&&cancelAnimationFrame(i),setTimeout(n)},s=setTimeout(r,100);Oe&&(i=requestAnimationFrame(r))})(wn)),M=null},g.__c=function(e,t){t.some(function(n){try{n.__h.forEach(lt),n.__h=n.__h.filter(function(i){return!i.__||Pt(i)})}catch(i){t.some(function(r){r.__h&&(r.__h=[])}),t=[],g.__e(i,n.__v)}}),ge&&ge(e,t)},g.unmount=function(e){ve&&ve(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(lt)}catch(n){g.__e(n,t.__v)}};var Oe=typeof requestAnimationFrame=="function";function lt(e){var t=M;typeof e.__c=="function"&&e.__c(),M=t}function Pt(e){var t=M;e.__c=e.__(),M=t}function Rt(e,t){return!e||e.length!==t.length||t.some(function(n,i){return n!==e[i]})}function Se(e,t){return typeof t=="function"?t(e):t}function Ie(e,t){for(var n in t)e[n]=t[n];return e}function Ct(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var i in t)if(i!=="__source"&&e[i]!==t[i])return!0;return!1}function xt(e){this.props=e}function On(e,t){function n(r){var s=this.props.ref,o=s==r.ref;return!o&&s&&(s.call?s(null):s.current=null),t?!t(this.props,r)||!o:Ct(this.props,r)}function i(r){return this.shouldComponentUpdate=n,P(e,r)}return i.displayName="Memo("+(e.displayName||e.name)+")",i.prototype.isReactComponent=!0,i.__f=!0,i}(xt.prototype=new R).isPureReactComponent=!0,xt.prototype.shouldComponentUpdate=function(e,t){return Ct(this.props,e)||Ct(this.state,t)};var Ee=g.__b;g.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Ee&&Ee(e)};var Sn=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function In(e){function t(n,i){var r=Ie({},n);return delete r.ref,e(r,(i=n.ref||i)&&(typeof i!="object"||"current"in i)?i:null)}return t.$$typeof=Sn,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var Me=function(e,t){return e==null?null:D(D(e).map(t))},En={map:Me,forEach:Me,count:function(e){return e?D(e).length:0},only:function(e){var t=D(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:D},Mn=g.__e;g.__e=function(e,t,n){if(e.then){for(var i,r=t;r=r.__;)if((i=r.__c)&&i.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),i.__c(e,t)}Mn(e,t,n)};var ke=g.unmount;function ct(){this.__u=0,this.t=null,this.__b=null}function $e(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function kn(e){var t,n,i;function r(s){if(t||(t=e()).then(function(o){n=o.default||o},function(o){i=o}),i)throw i;if(!n)throw t;return P(n,s)}return r.displayName="Lazy",r.__f=!0,r}function nt(){this.u=null,this.o=null}g.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),ke&&ke(e)},(ct.prototype=new R).__c=function(e,t){var n=t.__c,i=this;i.t==null&&(i.t=[]),i.t.push(n);var r=$e(i.__v),s=!1,o=function(){s||(s=!0,n.__R=null,r?r(h):h())};n.__R=o;var h=function(){if(!--i.__u){if(i.state.__e){var f=i.state.__e;i.__v.__k[0]=function l(c,p,_){return c&&(c.__v=null,c.__k=c.__k&&c.__k.map(function(m){return l(m,p,_)}),c.__c&&c.__c.__P===p&&(c.__e&&_.insertBefore(c.__e,c.__d),c.__c.__e=!0,c.__c.__P=_)),c}(f,f.__c.__P,f.__c.__O)}var a;for(i.setState({__e:i.__b=null});a=i.t.pop();)a.forceUpdate()}},u=t.__h===!0;i.__u++||u||i.setState({__e:i.__b=i.__v.__k[0]}),e.then(o,o)},ct.prototype.componentWillUnmount=function(){this.t=[]},ct.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),i=this.__v.__k[0].__c;this.__v.__k[0]=function s(o,h,u){return o&&(o.__c&&o.__c.__H&&(o.__c.__H.__.forEach(function(f){typeof f.__c=="function"&&f.__c()}),o.__c.__H=null),(o=Ie({},o)).__c!=null&&(o.__c.__P===u&&(o.__c.__P=h),o.__c=null),o.__k=o.__k&&o.__k.map(function(f){return s(f,h,u)})),o}(this.__b,n,i.__O=i.__P)}this.__b=null}var r=t.__e&&P(N,null,e.fallback);return r&&(r.__h=null),[P(N,null,t.__e?null:e.children),r]};var Pe=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};function $n(e){return this.getChildContext=function(){return e.context},e.children}function Pn(e){var t=this,n=e.i;t.componentWillUnmount=function(){B(null,t.l),t.l=null,t.i=null},t.i&&t.i!==n&&t.componentWillUnmount(),e.__v?(t.l||(t.i=n,t.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(i){this.childNodes.push(i),t.i.appendChild(i)},insertBefore:function(i,r){this.childNodes.push(i),t.i.appendChild(i)},removeChild:function(i){this.childNodes.splice(this.childNodes.indexOf(i)>>>1,1),t.i.removeChild(i)}}),B(P($n,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function Rn(e,t){return P(Pn,{__v:e,i:t})}(nt.prototype=new R).__e=function(e){var t=this,n=$e(t.__v),i=t.o.get(e);return i[0]++,function(r){var s=function(){t.props.revealOrder?(i.push(r),Pe(t,e,i)):r()};n?n(s):s()}},nt.prototype.render=function(e){this.u=null,this.o=new Map;var t=D(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},nt.prototype.componentDidUpdate=nt.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){Pe(e,n,t)})};var Re=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.element")||60103,Cn=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,xn=typeof document!="undefined",Dn=function(e){return(typeof Symbol!="undefined"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(e)};function Ln(e,t,n){return t.__k==null&&(t.textContent=""),B(e,t),typeof n=="function"&&n(),e?e.__c:null}function An(e,t,n){return Et(e,t),typeof n=="function"&&n(),e?e.__c:null}R.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(R.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var Ce=g.event;function jn(){}function Un(){return this.cancelBubble}function Nn(){return this.defaultPrevented}g.event=function(e){return Ce&&(e=Ce(e)),e.persist=jn,e.isPropagationStopped=Un,e.isDefaultPrevented=Nn,e.nativeEvent=e};var xe,De={configurable:!0,get:function(){return this.class}},Le=g.vnode;g.vnode=function(e){var t=e.type,n=e.props,i=n;if(typeof t=="string"){var r=t.indexOf("-")===-1;for(var s in i={},n){var o=n[s];xn&&s==="children"&&t==="noscript"||s==="value"&&"defaultValue"in n&&o==null||(s==="defaultValue"&&"value"in n&&n.value==null?s="value":s==="download"&&o===!0?o="":/ondoubleclick/i.test(s)?s="ondblclick":/^onchange(textarea|input)/i.test(s+t)&&!Dn(n.type)?s="oninput":/^on(Ani|Tra|Tou|BeforeInp)/.test(s)?s=s.toLowerCase():r&&Cn.test(s)?s=s.replace(/[A-Z0-9]/,"-$&").toLowerCase():o===null&&(o=void 0),i[s]=o)}t=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=D(n.children).forEach(function(h){h.props.selected=i.value.indexOf(h.props.value)!=-1})),t=="select"&&i.defaultValue!=null&&(i.value=D(n.children).forEach(function(h){h.props.selected=i.multiple?i.defaultValue.indexOf(h.props.value)!=-1:i.defaultValue==h.props.value})),e.props=i}t&&n.class!=n.className&&(De.enumerable="className"in n,n.className!=null&&(i.class=n.className),Object.defineProperty(i,"className",De)),e.$$typeof=Re,Le&&Le(e)};var Ae=g.__r;g.__r=function(e){Ae&&Ae(e),xe=e.__c};var Tn={ReactCurrentDispatcher:{current:{readContext:function(e){return xe.__n[e.__c].props.value}}}};function Vn(e){return P.bind(null,e)}function je(e){return!!e&&e.$$typeof===Re}function Hn(e){return je(e)?ce.apply(null,arguments):e}function Fn(e){return!!e.__k&&(B(null,e),!0)}function Wn(e){return e&&(e.base||e.nodeType===1&&e)||null}var qn=function(e,t){return e(t)},Bn=function(e,t){return e(t)},Gn={useState:tt,useReducer:be,useEffect:et,useLayoutEffect:ye,useRef:vn,useImperativeHandle:bn,useMemo:kt,useCallback:$t,useContext:we,useDebugValue:yn,version:"17.0.2",Children:En,render:Ln,hydrate:An,unmountComponentAtNode:Fn,createPortal:Rn,createElement:P,createContext:ft,createFactory:Vn,cloneElement:Hn,createRef:ee,Fragment:N,isValidElement:je,findDOMNode:Wn,Component:R,PureComponent:xt,memo:On,forwardRef:In,flushSync:Bn,unstable_batchedUpdates:qn,StrictMode:N,Suspense:ct,SuspenseList:nt,lazy:kn,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Tn},Jn=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function zn(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),t}var Zn=function(e,t){for(var n=[],i=0;i<e.length;i++){var r=t(e[i],i);Kn(r)?n.push.apply(n,r):n.push(r)}return n},Kn=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},Yn=Ue;function Ue(e,t,n){e instanceof RegExp&&(e=Ne(e,n)),t instanceof RegExp&&(t=Ne(t,n));var i=Te(e,t,n);return i&&{start:i[0],end:i[1],pre:n.slice(0,i[0]),body:n.slice(i[0]+e.length,i[1]),post:n.slice(i[1]+t.length)}}function Ne(e,t){var n=t.match(e);return n?n[0]:null}Ue.range=Te;function Te(e,t,n){var i,r,s,o,h,u=n.indexOf(e),f=n.indexOf(t,u+1),a=u;if(u>=0&&f>0){if(e===t)return[u,f];for(i=[],s=n.length;a>=0&&!h;)a==u?(i.push(a),u=n.indexOf(e,a+1)):i.length==1?h=[i.pop(),f]:(r=i.pop(),r<s&&(s=r,o=f),f=n.indexOf(t,a+1)),a=u<f&&u>=0?u:f;i.length&&(h=[s,o])}return h}var Qn=Zn,Ve=Yn,Xn=ni,He="\0SLASH"+Math.random()+"\0",Fe="\0OPEN"+Math.random()+"\0",Dt="\0CLOSE"+Math.random()+"\0",We="\0COMMA"+Math.random()+"\0",qe="\0PERIOD"+Math.random()+"\0";function Lt(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function ti(e){return e.split("\\\\").join(He).split("\\{").join(Fe).split("\\}").join(Dt).split("\\,").join(We).split("\\.").join(qe)}function ei(e){return e.split(He).join("\\").split(Fe).join("{").split(Dt).join("}").split(We).join(",").split(qe).join(".")}function Be(e){if(!e)return[""];var t=[],n=Ve("{","}",e);if(!n)return e.split(",");var i=n.pre,r=n.body,s=n.post,o=i.split(",");o[o.length-1]+="{"+r+"}";var h=Be(s);return s.length&&(o[o.length-1]+=h.shift(),o.push.apply(o,h)),t.push.apply(t,o),t}function ni(e){return e?(e.substr(0,2)==="{}"&&(e="\\{\\}"+e.substr(2)),z(ti(e),!0).map(ei)):[]}function ii(e){return"{"+e+"}"}function si(e){return/^-?0\d/.test(e)}function ri(e,t){return e<=t}function ai(e,t){return e>=t}function z(e,t){var n=[],i=Ve("{","}",e);if(!i||/\$$/.test(i.pre))return[e];var r=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),s=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),o=r||s,h=i.body.indexOf(",")>=0;if(!o&&!h)return i.post.match(/,.*\}/)?(e=i.pre+"{"+i.body+Dt+i.post,z(e)):[e];var u;if(o)u=i.body.split(/\.\./);else if(u=Be(i.body),u.length===1&&(u=z(u[0],!1).map(ii),u.length===1)){var a=i.post.length?z(i.post,!1):[""];return a.map(function(bt){return i.pre+u[0]+bt})}var f=i.pre,a=i.post.length?z(i.post,!1):[""],l;if(o){var c=Lt(u[0]),p=Lt(u[1]),_=Math.max(u[0].length,u[1].length),m=u.length==3?Math.abs(Lt(u[2])):1,d=ri,v=p<c;v&&(m*=-1,d=ai);var b=u.some(si);l=[];for(var y=c;d(y,p);y+=m){var O;if(s)O=String.fromCharCode(y),O==="\\"&&(O="");else if(O=String(y),b){var S=_-O.length;if(S>0){var rt=new Array(S+1).join("0");y<0?O="-"+rt+O.slice(1):O=rt+O}}l.push(O)}}else l=Qn(u,function(at){return z(at,!1)});for(var W=0;W<l.length;W++)for(var F=0;F<a.length;F++){var j=f+l[W]+a[F];(!t||o||j)&&n.push(j)}return n}var oi=$;$.Minimatch=I;var it={sep:"/"};try{it=require("path")}catch{}var At=$.GLOBSTAR=I.GLOBSTAR={},ui=Xn,Ge={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},jt="[^/]",Ut=jt+"*?",hi="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",fi="(?:(?!(?:\\/|^)\\.).)*?",Je=li("().*{}+?[]^$\\!");function li(e){return e.split("").reduce(function(t,n){return t[n]=!0,t},{})}var ze=/\/+/;$.filter=ci;function ci(e,t){return t=t||{},function(n,i,r){return $(n,e,t)}}function Ze(e,t){e=e||{},t=t||{};var n={};return Object.keys(t).forEach(function(i){n[i]=t[i]}),Object.keys(e).forEach(function(i){n[i]=e[i]}),n}$.defaults=function(e){if(!e||!Object.keys(e).length)return $;var t=$,n=function(r,s,o){return t.minimatch(r,s,Ze(e,o))};return n.Minimatch=function(r,s){return new t.Minimatch(r,Ze(e,s))},n};I.defaults=function(e){return!e||!Object.keys(e).length?I:$.defaults(e).Minimatch};function $(e,t,n){if(typeof t!="string")throw new TypeError("glob pattern string required");return n||(n={}),!n.nocomment&&t.charAt(0)==="#"?!1:t.trim()===""?e==="":new I(t,n).match(e)}function I(e,t){if(!(this instanceof I))return new I(e,t);if(typeof e!="string")throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),it.sep!=="/"&&(e=e.split(it.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}I.prototype.debug=function(){};I.prototype.make=pi;function pi(){if(!this._made){var e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error),this.debug(this.pattern,n),n=this.globParts=n.map(function(i){return i.split(ze)}),this.debug(this.pattern,n),n=n.map(function(i,r,s){return i.map(this.parse,this)},this),this.debug(this.pattern,n),n=n.filter(function(i){return i.indexOf(!1)===-1}),this.debug(this.pattern,n),this.set=n}}I.prototype.parseNegate=_i;function _i(){var e=this.pattern,t=!1,n=this.options,i=0;if(!n.nonegate){for(var r=0,s=e.length;r<s&&e.charAt(r)==="!";r++)t=!t,i++;i&&(this.pattern=e.substr(i)),this.negate=t}}$.braceExpand=function(e,t){return Ke(e,t)};I.prototype.braceExpand=Ke;function Ke(e,t){if(t||(this instanceof I?t=this.options:t={}),e=typeof e=="undefined"?this.pattern:e,typeof e=="undefined")throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:ui(e)}I.prototype.parse=di;var pt={};function di(e,t){if(e.length>1024*64)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&e==="**")return At;if(e==="")return"";var i="",r=!!n.nocase,s=!1,o=[],h=[],u,f=!1,a=-1,l=-1,c=e.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",p=this;function _(){if(u){switch(u){case"*":i+=Ut,r=!0;break;case"?":i+=jt,r=!0;break;default:i+="\\"+u;break}p.debug("clearStateChar %j %j",u,i),u=!1}}for(var m=0,d=e.length,v;m<d&&(v=e.charAt(m));m++){if(this.debug("%s	%s %s %j",e,m,i,v),s&&Je[v]){i+="\\"+v,s=!1;continue}switch(v){case"/":return!1;case"\\":_(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,m,i,v),f){this.debug("  in class"),v==="!"&&m===l+1&&(v="^"),i+=v;continue}p.debug("call clearStateChar %j",u),_(),u=v,n.noext&&_();continue;case"(":if(f){i+="(";continue}if(!u){i+="\\(";continue}o.push({type:u,start:m-1,reStart:i.length,open:Ge[u].open,close:Ge[u].close}),i+=u==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,i),u=!1;continue;case")":if(f||!o.length){i+="\\)";continue}_(),r=!0;var b=o.pop();i+=b.close,b.type==="!"&&h.push(b),b.reEnd=i.length;continue;case"|":if(f||!o.length||s){i+="\\|",s=!1;continue}_(),i+="|";continue;case"[":if(_(),f){i+="\\"+v;continue}f=!0,l=m,a=i.length,i+=v;continue;case"]":if(m===l+1||!f){i+="\\"+v,s=!1;continue}if(f){var y=e.substring(l+1,m);try{RegExp("["+y+"]")}catch{var O=this.parse(y,pt);i=i.substr(0,a)+"\\["+O[0]+"\\]",r=r||O[1],f=!1;continue}}r=!0,f=!1,i+=v;continue;default:_(),s?s=!1:Je[v]&&!(v==="^"&&f)&&(i+="\\"),i+=v}}for(f&&(y=e.substr(l+1),O=this.parse(y,pt),i=i.substr(0,a)+"\\["+O[0],r=r||O[1]),b=o.pop();b;b=o.pop()){var S=i.slice(b.reStart+b.open.length);this.debug("setting tail",i,b),S=S.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(Gt,Jt,Ot){return Ot||(Ot="\\"),Jt+Jt+Ot+"|"}),this.debug(`tail=%j
   %s`,S,S,b,i);var rt=b.type==="*"?Ut:b.type==="?"?jt:"\\"+b.type;r=!0,i=i.slice(0,b.reStart)+rt+"\\("+S}_(),s&&(i+="\\\\");var W=!1;switch(i.charAt(0)){case".":case"[":case"(":W=!0}for(var F=h.length-1;F>-1;F--){var j=h[F],at=i.slice(0,j.reStart),bt=i.slice(j.reStart,j.reEnd-8),qt=i.slice(j.reEnd-8,j.reEnd),Z=i.slice(j.reEnd);qt+=Z;var fn=at.split("(").length-1,yt=Z;for(m=0;m<fn;m++)yt=yt.replace(/\)[+*?]?/,"");Z=yt;var Bt="";Z===""&&t!==pt&&(Bt="$");var ln=at+bt+Z+Bt+qt;i=ln}if(i!==""&&r&&(i="(?=.)"+i),W&&(i=c+i),t===pt)return[i,r];if(!r)return vi(e);var cn=n.nocase?"i":"";try{var wt=new RegExp("^"+i+"$",cn)}catch{return new RegExp("$.")}return wt._glob=e,wt._src=i,wt}$.makeRe=function(e,t){return new I(e,t||{}).makeRe()};I.prototype.makeRe=mi;function mi(){if(this.regexp||this.regexp===!1)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,n=t.noglobstar?Ut:t.dot?hi:fi,i=t.nocase?"i":"",r=e.map(function(s){return s.map(function(o){return o===At?n:typeof o=="string"?bi(o):o._src}).join("\\/")}).join("|");r="^(?:"+r+")$",this.negate&&(r="^(?!"+r+").*$");try{this.regexp=new RegExp(r,i)}catch{this.regexp=!1}return this.regexp}$.match=function(e,t,n){n=n||{};var i=new I(t,n);return e=e.filter(function(r){return i.match(r)}),i.options.nonull&&!e.length&&e.push(t),e};I.prototype.match=gi;function gi(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;var n=this.options;it.sep!=="/"&&(e=e.split(it.sep).join("/")),e=e.split(ze),this.debug(this.pattern,"split",e);var i=this.set;this.debug(this.pattern,"set",i);var r,s;for(s=e.length-1;s>=0&&(r=e[s],!r);s--);for(s=0;s<i.length;s++){var o=i[s],h=e;n.matchBase&&o.length===1&&(h=[r]);var u=this.matchOne(h,o,t);if(u)return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}I.prototype.matchOne=function(e,t,n){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var r=0,s=0,o=e.length,h=t.length;r<o&&s<h;r++,s++){this.debug("matchOne loop");var u=t[s],f=e[r];if(this.debug(t,u,f),u===!1)return!1;if(u===At){this.debug("GLOBSTAR",[t,u,f]);var a=r,l=s+1;if(l===h){for(this.debug("** at the end");r<o;r++)if(e[r]==="."||e[r]===".."||!i.dot&&e[r].charAt(0)===".")return!1;return!0}for(;a<o;){var c=e[a];if(this.debug(`
globstar while`,e,a,t,l,c),this.matchOne(e.slice(a),t.slice(l),n))return this.debug("globstar found match!",a,o,c),!0;if(c==="."||c===".."||!i.dot&&c.charAt(0)==="."){this.debug("dot detected!",e,a,t,l);break}this.debug("globstar swallow a segment, and continue"),a++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,a,t,l),a===o))}var p;if(typeof u=="string"?(i.nocase?p=f.toLowerCase()===u.toLowerCase():p=f===u,this.debug("string match",u,f,p)):(p=f.match(u),this.debug("pattern match",u,f,p)),!p)return!1}if(r===o&&s===h)return!0;if(r===o)return n;if(s===h){var _=r===o-1&&e[r]==="";return _}throw new Error("wtf?")};function vi(e){return e.replace(/\\(.)/g,"$1")}function bi(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}var _t;(function(e){e.V0_3="0.3",e.V0_4="0.4"})(_t||(_t={}));var C;(function(e){e.V0_2="0.2",e.V0_3="0.3"})(C||(C={}));const Ye=Object.keys(_t);_t.V0_4;const Qe=Object.keys(C),dt=C.V0_3;var w;(function(e){e.Inputs="inputs",e.Outputs="outputs",e.State="state",e.Definition="definition",e.DefinitionUpdateRequest="definitionupdaterequest",e.Error="error",e.UrlHashUpdate="urlhashupdate",e.Message="Message"})(w||(w={}));var k;(function(e){e.InputsUpdate="InputsUpdate",e.OutputsUpdate="OutputsUpdate",e.SetupIframeClientRequest="SetupIframeClientRequest",e.SetupIframeServerResponseAck="SetupIframeServerResponseAck",e.PluginRequest="SetupIframeServerPluginRequestResponseAck",e.HashParamsUpdate="HashParamsUpdate"})(k||(k={}));var T;(function(e){e.InputsUpdate="InputsUpdate",e.MessageAck="MessageAck",e.SetupIframeServerResponse="SetupIframeServerResponse"})(T||(T={}));var Nt;(function(e){e.State="metapage/state"})(Nt||(Nt={}));const L="metapage/definition",V="metapage/state",Xe=Qe[Qe.length-1],yi=Ye[Ye.length-1];var st={exports:{}};(function(e,t){(function(n,i){e.exports=i()})(Jn,function(){var n=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function i(l,c){return l.indexOf(c)===-1?l.length:l.indexOf(c)}function r(l){var c=l.replace(/^v/,"").replace(/\+.*$/,""),p=i(c,"-"),_=c.substring(0,p).split(".");return _.push(c.substring(p+1)),_}function s(l){return isNaN(Number(l))?l:Number(l)}function o(l){if(typeof l!="string")throw new TypeError("Invalid argument expected string");if(!n.test(l))throw new Error("Invalid argument not valid semver ('"+l+"' received)")}function h(l,c){[l,c].forEach(o);for(var p=r(l),_=r(c),m=0;m<Math.max(p.length-1,_.length-1);m++){var d=parseInt(p[m]||0,10),v=parseInt(_[m]||0,10);if(d>v)return 1;if(v>d)return-1}var b=p[p.length-1],y=_[_.length-1];if(b&&y){var O=b.split(".").map(s),S=y.split(".").map(s);for(m=0;m<Math.max(O.length,S.length);m++){if(O[m]===void 0||typeof S[m]=="string"&&typeof O[m]=="number")return-1;if(S[m]===void 0||typeof O[m]=="string"&&typeof S[m]=="number"||O[m]>S[m])return 1;if(S[m]>O[m])return-1}}else if(b||y)return b?-1:1;return 0}var u=[">",">=","=","<","<="],f={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};function a(l){if(typeof l!="string")throw new TypeError("Invalid operator type, expected string but got "+typeof l);if(u.indexOf(l)===-1)throw new TypeError("Invalid operator, expected one of "+u.join("|"))}return h.validate=function(l){return typeof l=="string"&&n.test(l)},h.compare=function(l,c,p){a(p);var _=h(l,c);return f[p].indexOf(_)>-1},h})})(st);var mt={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function r(u,f,a){this.fn=u,this.context=f,this.once=a||!1}function s(u,f,a,l,c){if(typeof a!="function")throw new TypeError("The listener must be a function");var p=new r(a,l||u,c),_=n?n+f:f;return u._events[_]?u._events[_].fn?u._events[_]=[u._events[_],p]:u._events[_].push(p):(u._events[_]=p,u._eventsCount++),u}function o(u,f){--u._eventsCount==0?u._events=new i:delete u._events[f]}function h(){this._events=new i,this._eventsCount=0}h.prototype.eventNames=function(){var f=[],a,l;if(this._eventsCount===0)return f;for(l in a=this._events)t.call(a,l)&&f.push(n?l.slice(1):l);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(a)):f},h.prototype.listeners=function(f){var a=n?n+f:f,l=this._events[a];if(!l)return[];if(l.fn)return[l.fn];for(var c=0,p=l.length,_=new Array(p);c<p;c++)_[c]=l[c].fn;return _},h.prototype.listenerCount=function(f){var a=n?n+f:f,l=this._events[a];return l?l.fn?1:l.length:0},h.prototype.emit=function(f,a,l,c,p,_){var m=n?n+f:f;if(!this._events[m])return!1;var d=this._events[m],v=arguments.length,b,y;if(d.fn){switch(d.once&&this.removeListener(f,d.fn,void 0,!0),v){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,a),!0;case 3:return d.fn.call(d.context,a,l),!0;case 4:return d.fn.call(d.context,a,l,c),!0;case 5:return d.fn.call(d.context,a,l,c,p),!0;case 6:return d.fn.call(d.context,a,l,c,p,_),!0}for(y=1,b=new Array(v-1);y<v;y++)b[y-1]=arguments[y];d.fn.apply(d.context,b)}else{var O=d.length,S;for(y=0;y<O;y++)switch(d[y].once&&this.removeListener(f,d[y].fn,void 0,!0),v){case 1:d[y].fn.call(d[y].context);break;case 2:d[y].fn.call(d[y].context,a);break;case 3:d[y].fn.call(d[y].context,a,l);break;case 4:d[y].fn.call(d[y].context,a,l,c);break;default:if(!b)for(S=1,b=new Array(v-1);S<v;S++)b[S-1]=arguments[S];d[y].fn.apply(d[y].context,b)}}return!0},h.prototype.on=function(f,a,l){return s(this,f,a,l,!1)},h.prototype.once=function(f,a,l){return s(this,f,a,l,!0)},h.prototype.removeListener=function(f,a,l,c){var p=n?n+f:f;if(!this._events[p])return this;if(!a)return o(this,p),this;var _=this._events[p];if(_.fn)_.fn===a&&(!c||_.once)&&(!l||_.context===l)&&o(this,p);else{for(var m=0,d=[],v=_.length;m<v;m++)(_[m].fn!==a||c&&!_[m].once||l&&_[m].context!==l)&&d.push(_[m]);d.length?this._events[p]=d.length===1?d[0]:d:o(this,p)}return this},h.prototype.removeAllListeners=function(f){var a;return f?(a=n?n+f:f,this._events[a]&&o(this,a)):(this._events=new i,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=n,h.EventEmitter=h,e.exports=h})(mt);var gt;(function(e){e.mp_debug="mp_debug"})(gt||(gt={}));const wi=()=>{try{return window!==window.top}catch{return!1}};class Oi extends mt.exports.EventEmitter{constructor(){super();this._definition={version:C.V0_3,metaframes:{}},this.getDefinition=this.getDefinition.bind(this)}error(t){throw"Subclass should implement"}getDefinition(){return this._definition}}var Si=globalThis&&globalThis.__awaiter||function(e,t,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function h(a){try{f(i.next(a))}catch(l){o(l)}}function u(a){try{f(i.throw(a))}catch(l){o(l)}}function f(a){a.done?s(a.value):r(a.value).then(h,u)}f((i=i.apply(e,t||[])).next())})};const tn=e=>{if(e===null)throw"Metapage definition cannot be null";if(typeof e=="string")try{e=JSON.parse(e)}catch{throw`Cannot parse into JSON:
${e}`}let t;switch(Ei(e.version)){case C.V0_2:{t=tn(Ii(e));break}case C.V0_3:{t=e;break}default:console.warn(`Metapage definition version=${e.version} but we only know up to version ${dt}. Assuming the definition is compatible, but it's the future!`),t=e;break}return t},Ii=e=>(e.version=C.V0_3,e),vt=(e,t)=>{if(!t)return!1;let n=!1;return Object.keys(t).forEach(i=>{n=!0,t[i]===void 0?delete e[i]:e[i]=t[i]}),n},Ei=e=>{if(e=="latest")return dt;if(st.exports.compare(e,"0.2","<"))throw`Unknown version: ${e}`;return st.exports.compare(e,"0.2",">=")&&st.exports.compare(e,C.V0_3,"<")?C.V0_2:st.exports.compare(e,"0.3",">=")?C.V0_3:(console.log(`Could not match version=${e} to any known version, assuming ${dt}`),dt)},Tt=()=>{const e=new URLSearchParams(window.location.search).get(gt.mp_debug);return e==="true"||e==="1"},Mi=e=>e.filter(n=>new URLSearchParams(window.location.search).has(n)).length>0,ki=(e=8)=>$i(e),en="abcdefghijklmnopqrstuvwxyz0123456789",$i=(e=8)=>{for(var t="",n=en.length,i=0;i<e;i++)t+=en.charAt(Math.floor(Math.random()*n));return t},Vt=(e,t,n)=>{t=t||"000",t&&t.trim()==""&&(t=void 0);let i;if(typeof e=="string"?i=e:typeof e=="number"?i=e+"":i=JSON.stringify(e,null,"  "),t&&t.trim()!=""){var r=`color: #${t}`;n&&(r=`${r}; background: #${n}`),i=`%c${i}`,window.console.log(i,r)}else window.console.log(i)},nn=e=>Ri(Pi(e)),Pi=e=>{var t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t},Ri=e=>{var t=(e&16777215).toString(16).toUpperCase();return"00000".substring(0,6-t.length)+t},Ht=()=>document.readyState=="complete"||document.readyState=="interactive",Ft=()=>Si(void 0,void 0,void 0,function*(){return Ht()?Promise.resolve():new Promise(e=>{if(Ht()){e();return}let t=!1;window.addEventListener("load",()=>{t||(t=!0,e())}),setTimeout(()=>{!t&&Ht()&&(t=!0,e())},200)})});var sn=globalThis&&globalThis.__awaiter||function(e,t,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function h(a){try{f(i.next(a))}catch(l){o(l)}}function u(a){try{f(i.throw(a))}catch(l){o(l)}}function f(a){a.done?s(a.value):r(a.value).then(h,u)}f((i=i.apply(e,t||[])).next())})};class rn extends mt.exports.EventEmitter{constructor(t,n,i,r,s,o=!1){super();if(this.inputs={},this.outputs={},this._disposables=[],this._rpcListeners=[],this._loaded=!1,this._onLoaded=[],this._sendInputsAfterRegistration=!1,this._plugin=!1,this._cachedEventInputsUpdate={iframeId:void 0,inputs:void 0},this._cachedEventOutputsUpdate={iframeId:null,inputs:null},!n.startsWith("http")){for(;n.startsWith("/");)n=n.substr(1);n=window.location.protocol+"//"+window.location.hostname+(window.location.port&&window.location.port!=""?":"+window.location.port:"")+"/"+n}this.url=n,this._metapage=t;var h=new URL(this.url);o&&h.searchParams.set(gt.mp_debug,"true"),this.url=h.href,this.id=i,this._debug=o,this._parentId=r,this._color=nn(this.id),this._consoleBackgroundColor=s,this._iframe=document.createElement("iframe"),this._iframe.name=this.id;const u=this;this.iframe=new Promise(f=>{Ft().then(()=>sn(this,void 0,void 0,function*(){if(u._iframe){const a=yield u.getDefinition();if(!u._iframe)return;(a==null?void 0:a.allow)&&(u._iframe.allow=a.allow),u._iframe.src=this.url,f(u._iframe)}}))}),this.ack=this.ack.bind(this),this.dispose=this.dispose.bind(this),this.getDefinition=this.getDefinition.bind(this),this.getDefinitionUrl=this.getDefinitionUrl.bind(this),this.setPlugin=this.setPlugin.bind(this),this.hasPermissionsDefinition=this.hasPermissionsDefinition.bind(this),this.hasPermissionsState=this.hasPermissionsState.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.onInput=this.onInput.bind(this),this.onInputs=this.onInputs.bind(this),this.onOutput=this.onOutput.bind(this),this.onOutputs=this.onOutputs.bind(this),this.register=this.register.bind(this),this.registered=this.registered.bind(this),this.sendInputs=this.sendInputs.bind(this),this.sendOrBufferPostMessage=this.sendOrBufferPostMessage.bind(this),this.sendRpc=this.sendRpc.bind(this),this.sendRpcInternal=this.sendRpcInternal.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setMetapage=this.setMetapage.bind(this),this.setOutput=this.setOutput.bind(this),this.setOutputs=this.setOutputs.bind(this),this.setPlugin=this.setPlugin.bind(this),this.addListenerReturnDisposer=this.addListenerReturnDisposer.bind(this),this.isDisposed=this.isDisposed.bind(this)}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}setPlugin(){if(this._loaded)throw"Cannot setPlugin after MetapageIFrameRpcClient already loaded";return this._plugin=!0,this}setMetapage(t){return this._metapage=t,this}hasPermissionsState(){return this._definition!==void 0&&this._definition.inputs!==void 0&&this._definition.inputs[V]!==void 0}hasPermissionsDefinition(){return this._definition!==void 0&&this._definition.inputs!==void 0&&this._definition.inputs[L]!==void 0}getDefinitionUrl(){var t=new URL(this.url);return t.pathname=t.pathname+(t.pathname.endsWith("/")?"metaframe.json":"/metaframe.json"),t.href}getDefinition(){return sn(this,void 0,void 0,function*(){if(this._definition)return this._definition;var t=this.getDefinitionUrl();try{const n=yield window.fetch(t);if(n.ok){const i=yield n.json();return this._definition=i,this._definition}else this.emit(w.Error,`Failed to fetch: ${t}
Status: ${n.status}
Status text: ${n.statusText}`)}catch(n){this.emit(w.Error,`Failed to fetch: ${t}
Error: ${n}`)}})}setInput(t,n){console.assert(!!t);var i={};i[t]=n,this.setInputs(i)}setInputs(t){if(this.log({m:"MetapageIFrameRpcClient",inputs:t}),!vt(this.inputs,t))return this;if(this._loaded||(this._sendInputsAfterRegistration=!0),this._iframe.parentNode&&this._loaded&&this.sendInputs(t),this.emit(w.Inputs,this.inputs),this._metapage.listenerCount(w.Inputs)>0){var n={};n[this.id]=t,this._metapage.emit(w.Inputs,n)}return this}setOutput(t,n){console.assert(!!t);var i={};i[t]=n,this.setOutputs(i)}setOutputs(t){if(!!vt(this.outputs,t)&&(this.emit(w.Outputs,t),this._metapage.listenerCount(w.Outputs)>0)){var n={};n[this.id]=this.outputs,this._metapage.emit(w.Outputs,n)}}onInputs(t){return this.addListenerReturnDisposer(w.Inputs,t)}onInput(t,n){var i=function(r){r.hasOwnProperty(t)&&n(r[t])};return this.addListenerReturnDisposer(w.Inputs,i)}onOutputs(t){return this.addListenerReturnDisposer(w.Outputs,t)}onOutput(t,n){var i=function(r){r.hasOwnProperty(t)&&n(r[t])};return this.addListenerReturnDisposer(w.Outputs,i)}isDisposed(){return this.inputs===void 0}dispose(){for(super.removeAllListeners();this._disposables&&this._disposables.length>0;){const t=this._disposables.pop();t&&t()}this._rpcListeners=void 0,this.inputs=void 0,this.outputs=void 0,this._iframe&&this._iframe.parentNode&&this._iframe.parentNode.removeChild(this._iframe),this._iframe=void 0,this._bufferMessages=void 0,this._bufferTimeout&&(window.clearInterval(this._bufferTimeout),this._bufferTimeout=void 0),this._metapage=void 0}register(){var t={iframeId:this.id,parentId:this._parentId,plugin:this._plugin,state:{inputs:this.inputs},version:Xe};this.sendRpcInternal(T.SetupIframeServerResponse,t)}registered(t){if(this.log({m:"MetapageIFrameRpcClient.registered",inputs:this.inputs}),!this._loaded){if(!t)throw"Cannot register without a version";for(this.version=t,this._loaded=!0;this._onLoaded&&this._onLoaded.length>0;)this._onLoaded.pop()();this._sendInputsAfterRegistration&&this.sendInputs(this.inputs)}}sendInputs(t){this.sendRpc(T.InputsUpdate,{inputs:t,parentId:this._parentId})}sendRpc(t,n){if(this._iframe.parentNode&&this._loaded)this.sendRpcInternal(t,n);else{this._metapage.error("sending rpc later");const i=this;this._onLoaded.push(()=>{i.sendRpcInternal(t,n)})}}ack(t){if(this.log("\u2692 \u2692 \u2692 calling ack"),this._debug){this.log("\u2692 \u2692 \u2692 sending ack from client to frame");var n={message:t};this.sendRpc(T.MessageAck,n)}else this.log("\u2692 \u2692 \u2692 NOT sending ack from client to frame since not debug mode")}log(t){!this._debug||this.logInternal(t)}logInternal(t){let n;typeof t=="string"?n=t:typeof t=="string"?n=t+"":n=JSON.stringify(t),Vt(`Metapage[${this._parentId}] Metaframe[${this.id}] ${n}`,this._color,this._consoleBackgroundColor)}sendRpcInternal(t,n){const i={id:"_",iframeId:this.id,jsonrpc:"2.0",method:t,params:n,parentId:this._parentId};this._iframe?this.sendOrBufferPostMessage(i):this._metapage.error(`Cannot send to child iframe messageJSON=${JSON.stringify(i).substr(0,200)}`)}sendOrBufferPostMessage(t){if(this._iframe&&this._iframe.contentWindow)this._iframe.contentWindow.postMessage(t,this.url);else if(this._bufferMessages)this._bufferMessages.push(t);else{this._bufferMessages=[t];const n=this;this._bufferTimeout=window.setInterval(function(){n._iframe&&n._iframe.contentWindow&&(n._bufferMessages.forEach(i=>n._iframe.contentWindow.postMessage(i,n.url)),window.clearInterval(n._bufferTimeout),n._bufferTimeout=void 0,n._bufferMessages=void 0)},0)}}}var Ci=globalThis&&globalThis.__awaiter||function(e,t,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function h(a){try{f(i.next(a))}catch(l){o(l)}}function u(a){try{f(i.throw(a))}catch(l){o(l)}}function f(a){a.done?s(a.value):r(a.value).then(h,u)}f((i=i.apply(e,t||[])).next())})},an;(function(e){e.all="all",e.delta="delta"})(an||(an={}));const on=()=>({metaframes:{inputs:{},outputs:{}},plugins:{inputs:{},outputs:{}}}),xi="bcbcbc";class x extends Oi{constructor(t){super();this._state=on(),this._metaframes={},this._plugins={},this._pluginOrder=[],this.debug=Tt(),this._internalReceivedMessageCounter=0,this._cachedInputLookupMap={},this._inputMap={},this._id=t&&t.id?t.id:ki(),this._consoleBackgroundColor=t&&t.color?t.color:xi,this.addPipe=this.addPipe.bind(this),this.dispose=this.dispose.bind(this),this.addMetaframe=this.addMetaframe.bind(this),this.addPlugin=this.addPlugin.bind(this),this.getInputsFromOutput=this.getInputsFromOutput.bind(this),this.getMetaframe=this.getMetaframe.bind(this),this.getMetaframeIds=this.getMetaframeIds.bind(this),this.getMetaframeOrPlugin=this.getMetaframeOrPlugin.bind(this),this.getMetaframes=this.getMetaframes.bind(this),this.getPlugin=this.getPlugin.bind(this),this.getPluginIds=this.getPluginIds.bind(this),this.getState=this.getState.bind(this),this.getStateMetaframes=this.getStateMetaframes.bind(this),this.isValidJSONRpcMessage=this.isValidJSONRpcMessage.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.metaframeIds=this.metaframeIds.bind(this),this.metaframes=this.metaframes.bind(this),this.onMessage=this.onMessage.bind(this),this.pluginIds=this.pluginIds.bind(this),this.plugins=this.plugins.bind(this),this.removeAll=this.removeAll.bind(this),this.removeMetaframe=this.removeMetaframe.bind(this),this.removePlugin=this.removePlugin.bind(this),this.setDebugFromUrlParams=this.setDebugFromUrlParams.bind(this),this.setDefinition=this.setDefinition.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setInputStateOnly=this.setInputStateOnly.bind(this),this.setMetaframeClientInputAndSentClientEvent=this.setMetaframeClientInputAndSentClientEvent.bind(this),this.setOutputStateOnly=this.setOutputStateOnly.bind(this),this.setState=this.setState.bind(this),this.updatePluginsWithDefinition=this.updatePluginsWithDefinition.bind(this),this._emitDefinitionEvent=this._emitDefinitionEvent.bind(this),Ft().then(()=>{window.addEventListener("message",this.onMessage),this.log("Initialized")})}static from(t,n){if(t==null)throw"Metapage definition cannot be null";if(typeof t=="string")try{t=JSON.parse(t)}catch{throw"Cannot parse into JSON:\n${metaPageDef}"}var i=new x;return i.setDefinition(t)}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}setDebugFromUrlParams(){return this.debug=Mi(["MP_DEBUG","DEBUG","debug","mp_debug"]),this}getState(){return this._state}setState(t){this._state=t,this.getMetaframeIds().forEach(n=>{this.getMetaframe(n).setInputs(this._state.metaframes.inputs[n]),this.getMetaframe(n).setOutputs(this._state.metaframes.outputs[n])}),this.getPluginIds().forEach(n=>{this.getPlugin(n).setInputs(this._state.plugins.inputs[n]),this.getPlugin(n).setOutputs(this._state.plugins.outputs[n])}),this.emit(w.State,this._state)}getStateMetaframes(){return this._state.metaframes}getDefinition(){return this._definition}setDefinition(t,n){const i=tn(t);return i.metaframes&&Object.keys(i.metaframes).forEach(r=>{if(i.plugins&&i.plugins.includes(r))throw this.emitErrorMessage(`Plugin with url=${r} matches metaframe. Metaframe ids and plugin urls are not allowed to collide`),`Plugin with url=${r} matches metaframe. Metaframe ids and plugin urls are not allowed to collide`;var s=i.metaframes[r];if(typeof s!="object")throw this.emitErrorMessage(`Metaframe "${r}" is not an object`),`Metaframe "${r}" is not an object`;if(!s.url)throw this.emitErrorMessage(`Metaframe "${r}" missing field: url`),`Metaframe "${r}" missing field: url`}),this._definition=i,Object.keys(this._metaframes).forEach(r=>{(!i.metaframes||!i.metaframes[r])&&this.removeMetaframe(r)}),Object.keys(this._plugins).forEach(r=>{i.plugins&&!i.plugins.includes(r)&&this.removePlugin(r)}),this._pluginOrder=i.plugins?i.plugins:[],n&&(this._state=n),i.metaframes&&Object.keys(i.metaframes).forEach(r=>{if(!this._metaframes.hasOwnProperty(r)){const s=i.metaframes[r];this.addMetaframe(r,s)}}),i.plugins&&i.plugins.forEach(r=>{this._plugins.hasOwnProperty(r)||this.addPlugin(r)}),window.setTimeout(()=>{this._emitDefinitionEvent(),n&&this.emit(w.State,this._state)},0),this}_emitDefinitionEvent(){const t={definition:this._definition,metaframes:this._metaframes,plugins:this._plugins};this.emit(w.Definition,t)}addPipe(t,n){this._inputMap[t]||(this._inputMap[t]=[]),this._inputMap[t].push(n)}removeMetaframe(t){!this._metaframes[t]||(this._metaframes[t].dispose(),delete this._metaframes[t],delete this._state.metaframes.inputs[t],delete this._state.metaframes.outputs[t],delete this._inputMap[t],Object.keys(this._inputMap).forEach(n=>{var i;const r=this._inputMap[n];let s=0;for(;s<=r.length;)((i=r[s])===null||i===void 0?void 0:i.metaframe)===t?r.splice(s,1):s++}),this._cachedInputLookupMap={})}removePlugin(t){!this._plugins[t]||(this._plugins[t].dispose(),delete this._plugins[t],delete this._state.plugins.inputs[t],delete this._state.plugins.outputs[t])}removeAll(){Object.keys(this._metaframes).forEach(t=>this._metaframes[t].dispose()),Object.keys(this._plugins).forEach(t=>this._plugins[t].dispose()),this._metaframes={},this._plugins={},this._state=on(),this._inputMap={},this._cachedInputLookupMap={}}metaframes(){return this.getMetaframes()}metaframeIds(){return this.getMetaframeIds()}getMetaframeIds(){return Object.keys(this._metaframes)}getMetaframes(){return Object.assign({},this._metaframes)}plugins(){return Object.assign({},this._plugins)}pluginIds(){return this.getPluginIds()}getPluginIds(){return this._pluginOrder.slice(0)}getMetaframe(t){return this._metaframes[t]}getPlugin(t){return this._plugins[t]}addMetaframe(t,n){if(!t)throw"addMetaframe missing metaframeId";if(!n)throw"addMetaframe missing definition";if(this._metaframes[t])throw this.emitErrorMessage(`Existing metaframe for id=${t}`),`Existing metaframe for id=${t}`;if(!n.url)throw this.emitErrorMessage(`Metaframe definition missing url id=${t}`),`Metaframe definition missing url id=${t}`;var i=new rn(this,n.url,t,this._id,this._consoleBackgroundColor,this.debug).setMetapage(this);return this._metaframes[t]=i,i.addListener(w.Error,r=>{this.emit(w.Error,{metaframeId:i.id,metaframeUrl:i.url,error:r})}),n.inputs&&n.inputs.forEach(r=>this.addPipe(t,r)),i.setInputs(this._state.metaframes.inputs[t]),i}addPlugin(t){if(!t)throw"Plugin missing url";const n=new rn(this,t,t,this._id,this._consoleBackgroundColor,this.debug).setInputs(this._state.plugins.inputs[t]).setMetapage(this).setPlugin();return Di(this,n),this._plugins[t]=n,n}dispose(){super.removeAllListeners(),window.removeEventListener("message",this.onMessage),this._metaframes&&Object.keys(this._metaframes).forEach(t=>this._metaframes[t].dispose()),this._plugins&&Object.keys(this._plugins).forEach(t=>this._plugins[t].dispose()),this._id=void 0,this._metaframes=void 0,this._plugins=void 0,this._state=void 0,this._cachedInputLookupMap=void 0,this._inputMap=void 0}log(t,n,i){!this.debug||this.logInternal(t,n,i)}error(t){this.logInternal(t,"f00",this._consoleBackgroundColor),this.emitErrorMessage(`${t}`)}emitErrorMessage(t){this.emit(w.Error,t)}getInputsFromOutput(t,n){if(this._cachedInputLookupMap[t]||(this._cachedInputLookupMap[t]={}),!this._cachedInputLookupMap[t][n]){var i=[];this._cachedInputLookupMap[t][n]=i,Object.keys(this._inputMap).forEach(r=>{r!==t&&this._inputMap[r].forEach(s=>{if(s.metaframe==t&&oi(n,s.source)){var o=s.target;(!s.target||s.target.startsWith("*")||s.target==="")&&(o=n),i.push({metaframe:r,pipe:o})}})})}return this._cachedInputLookupMap[t][n]}isValidJSONRpcMessage(t){if(t.jsonrpc!=="2.0")return!1;switch(t.method){case k.SetupIframeClientRequest:return!0;default:var i=t.iframeId;return!(i&&!(t.parentId===this._id&&(this._metaframes[i]||this._plugins[i])))}}setInput(t,n,i){this.setInputStateOnly(t,n,i),this.setMetaframeClientInputAndSentClientEvent(t,n,i),this.emit(w.State,this._state),this.emit(w.Inputs,this._state)}setMetaframeClientInputAndSentClientEvent(t,n,i){if(typeof t=="object"){if(n||i)throw"bad arguments, see API docs";const r=t;Object.keys(r).forEach(s=>{var o=s,h=r[o];if(typeof h!="object")throw"bad arguments, see API docs";var u=this._metaframes[o];u?u.setInputs(h):this.error("No iframe id=$metaframeId")})}else if(typeof t=="string"){const r=this._metaframes[t];if(r==null&&this.error(`No iframe id=${t}`),typeof n=="string")r.setInput(n,i);else if(typeof n=="object")r.setInputs(n);else throw"bad arguments, see API docs"}else throw"bad arguments, see API docs"}setInputs(t,n,i){this.setInput(t,n,i)}setOutputStateOnly(t,n,i){this._setStateOnly(!1,t,n,i)}setInputStateOnly(t,n,i){this._setStateOnly(!0,t,n,i)}_setStateOnly(t,n,i,r){if(typeof n=="object"){if(i||r)throw"If first argument is an object, subsequent args should be undefined";const s=n;Object.keys(s).forEach(o=>{var h=s[o];if(typeof h!="object")throw"Object values must be objects";const u=this._metaframes.hasOwnProperty(o);if(!u&&!this._plugins.hasOwnProperty(o))throw"No metaframe or plugin: ${metaframeId}";const f=u?t?this._state.metaframes.inputs:this._state.metaframes.outputs:t?this._state.plugins.inputs:this._state.plugins.outputs;f[o]=f[o]?f[o]:{},Object.keys(h).forEach(a=>{h[a]===void 0?delete f[o][a]:f[o][a]=h[a]})})}else if(typeof n=="string"){const s=n,o=this._metaframes.hasOwnProperty(s);if(!o&&!this._plugins.hasOwnProperty(s))throw`No metaframe or plugin: ${s}`;const h=o?t?this._state.metaframes.inputs:this._state.metaframes.outputs:t?this._state.plugins.inputs:this._state.plugins.outputs;if(typeof i=="string"){h[s]=h[s]?h[s]:{};const u=i;r===void 0?delete h[s][u]:h[s][u]=r}else if(typeof i=="object"){h[s]=h[s]?h[s]:{};const u=i;Object.keys(u).forEach(f=>{u[f]===void 0?delete h[s][f]:h[s][f]=u[f]})}else throw"Second argument must be a string or an object"}else throw"First argument must be a string or an object"}getMetaframeOrPlugin(t){var n=this._metaframes[t];return n||(n=this._plugins[t]),n}onMessage(t){if(typeof t.data=="object"){const o=t.data;if(!this.isValidJSONRpcMessage(o))return;var n=o.method;const h=o.iframeId;if(!h)return;const u=this.getMetaframeOrPlugin(h),f=this._plugins[h];switch(o._messageCount=++this._internalReceivedMessageCounter,this.debug&&this.log(`processing ${JSON.stringify(o,null,"  ").substr(0,500)}`),n){case k.SetupIframeClientRequest:u&&u.register();break;case k.SetupIframeServerResponseAck:if(u){const l=o.params;u.registered(l.version)}break;case k.OutputsUpdate:const a=o.params;if(this._metaframes[h]){var i=this._metaframes[h];this.setOutputStateOnly(h,a),i.setOutputs(a),this.emit(w.State,this._state);var r=!1;const l=Object.keys(a),c={};l.forEach((p,_)=>{const m=this.getInputsFromOutput(h,p);m.length>0&&m.forEach(d=>{c[d.metaframe]||(c[d.metaframe]={}),c[d.metaframe][d.pipe]=a[p],this.setInputStateOnly(d.metaframe,d.pipe,a[p]),r=!0})}),Object.keys(c).forEach(p=>{this._metaframes[p].setInputs(c[p])}),r&&this.emit(w.State,this._state),this.debug&&i.ack({jsonrpc:o,state:this._state})}else if(this._plugins[h]){const l=!a[V]&&!a[L];l&&this.setOutputStateOnly(h,a),this._plugins[h].setOutputs(a),l&&this.emit(w.State,this._state),this.debug&&this._plugins[h].ack({jsonrpc:o,state:this._state})}else this.error("missing metaframe/plugin=$metaframeId");break;case k.InputsUpdate:var s=o.params;if(this.debug&&this.log(`inputs ${JSON.stringify(s)} from ${h}`),this._metaframes[h])this.setInputStateOnly(h,s),this._metaframes[h].setInputs(s),this.emit(w.State,this._state),this.debug&&this._metaframes[h].ack({jsonrpc:o,state:this._state});else if(this._plugins[h]){const l=!s[V]&&!s[L];l&&this.setInputStateOnly(h,s),this._plugins[h].setInputs(s),l&&this.emit(w.State,this._state),this.debug&&this._plugins[h].ack({jsonrpc:o,state:this._state})}else console.error(`InputsUpdate failed no metaframe or plugin id: "${h}"`),this.error(`InputsUpdate failed no metaframe or plugin id: "${h}"`);break;case k.PluginRequest:f&&u&&u.hasPermissionsState()&&(u.setInput(V,this._state),this.debug&&u.ack({jsonrpc:o,state:this._state}));break;case k.HashParamsUpdate:if(!f&&u){const l=o.params,c=new URL(u.url);c.hash=l.hash,u.url=c.href,this._definition.metaframes[l.metaframe].url=c.href,this.emit(w.UrlHashUpdate,o.params),this._emitDefinitionEvent()}break;default:this.debug&&this.log(`Unknown RPC method: "${n}"`)}this.emit(w.Message,o)}}updatePluginsWithDefinition(){this.getDefinition(),Object.values(this._plugins).forEach(t=>{t.hasPermissionsDefinition()&&Li(t)})}logInternal(t,n,i){i=i||this._consoleBackgroundColor;let r;typeof t=="string"?r=t:typeof t=="number"?r=t+"":r=JSON.stringify(t),r=this._id?`Metapage[${this._id}] ${r}`:r,Vt(r,n,i)}}x.version=Xe;x.DEFINITION=w.Definition;x.DEFINITION_UPDATE_REQUEST=w.DefinitionUpdateRequest;x.ERROR=w.Error;x.INPUTS=w.Inputs;x.MESSAGE=w.Message;x.OUTPUTS=w.Outputs;x.STATE=w.State;x.URL_HASH_UPDATE=w.UrlHashUpdate;const Di=(e,t)=>Ci(void 0,void 0,void 0,function*(){try{const r=yield t.getDefinition();if(!r)throw`${t.url}`;if(t.isDisposed())return;if(t.hasPermissionsDefinition()){var n=e.addListenerReturnDisposer(w.Definition,s=>{t.setInput(L,s.definition)});t._disposables.push(n);var i=e.getDefinition();if(i&&(t.setInput(L,i),r.outputs)){var n=t.onOutput(L,o=>{e.emit(w.DefinitionUpdateRequest,o)});t._disposables.push(n)}}if(t.hasPermissionsState()&&r.outputs){var n=t.onOutput(V,o=>{e.setState(o)});t._disposables.push(n)}}catch(r){console.error(r),e.emit(w.Error,`Failed to get plugin definition from "${t.getDefinitionUrl()}", error=${r}`)}}),Li=e=>{const t=e._metapage.getDefinition();e.setInput(L,t)};var Ai=globalThis&&globalThis.__awaiter||function(e,t,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function h(a){try{f(i.next(a))}catch(l){o(l)}}function u(a){try{f(i.throw(a))}catch(l){o(l)}}function f(a){a.done?s(a.value):r(a.value).then(h,u)}f((i=i.apply(e,t||[])).next())})},H;(function(e){e.WaitingForPageLoad="WaitingForPageLoad",e.SentSetupIframeClientRequest="SentSetupIframeClientRequest",e.Ready="Ready"})(H||(H={}));var E;(function(e){e.Connected="connected",e.Error="error",e.Input="input",e.Inputs="inputs",e.Message="message"})(E||(E={}));class A extends mt.exports.EventEmitter{constructor(t){super();if(this._inputPipeValues={},this._outputPipeValues={},this._state=H.WaitingForPageLoad,this._messageSendCount=0,this.debug=Tt(),this.id=window.name,this.debug=Tt(),this._isIframe=wi(),this.addListener=this.addListener.bind(this),this.dispose=this.dispose.bind(this),this.error=this.error.bind(this),this.getInput=this.getInput.bind(this),this.getInputs=this.getInputs.bind(this),this.getOutput=this.getOutput.bind(this),this.getOutputs=this.getOutputs.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.onInput=this.onInput.bind(this),this.onInputs=this.onInputs.bind(this),this.onMessage=this.onMessage.bind(this),this.sendRpc=this.sendRpc.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setInternalInputsAndNotify=this.setInternalInputsAndNotify.bind(this),this.setOutput=this.setOutput.bind(this),this.setOutputs=this.setOutputs.bind(this),this.warn=this.warn.bind(this),this._resolveSetupIframeServerResponse=this._resolveSetupIframeServerResponse.bind(this),this.addListenerReturnDisposer=this.addListenerReturnDisposer.bind(this),this.connected=this.connected.bind(this),this.disableNotifyOnHashUrlChange=this.disableNotifyOnHashUrlChange.bind(this),this._onHashUrlChange=this._onHashUrlChange.bind(this),!this._isIframe){this.log("Not an iframe, metaframe code disabled");return}const n=this;Ft().then(()=>{this.log("pageLoaded"),window.addEventListener("message",this.onMessage),n.sendRpc(k.SetupIframeClientRequest,{version:A.version}),n._state=H.SentSetupIframeClientRequest}),(t==null?void 0:t.disableHashChangeEvent)||window.addEventListener("hashchange",this._onHashUrlChange)}_resolveSetupIframeServerResponse(t){if(this._state===H.WaitingForPageLoad)throw"Got message but page has not finished loading, we should never get in this state";this._parentId?this.log("Got JsonRpcMethods.SetupIframeServerResponse but already resolved"):(this._parentVersion=t.version,this.color=nn(this.id),this._parentId=t.parentId,this.log(`metapage[${this._parentId}](v${this._parentVersion?this._parentVersion:"unknown"}) registered`),this._inputPipeValues=t.state&&t.state.inputs?t.state.inputs:this._inputPipeValues,this._state=H.Ready,this.sendRpc(k.SetupIframeServerResponseAck,{version:A.version}),this._inputPipeValues&&Object.keys(this._inputPipeValues).length>0&&(this.emit(E.Inputs,this._inputPipeValues),Object.keys(this._inputPipeValues).forEach(n=>this.emit(E.Input,n,this._inputPipeValues[n]))),this.emit(E.Inputs,this._inputPipeValues),t.plugin&&(this.plugin=new ji(this)),this.emit(E.Connected))}connected(){return Ai(this,void 0,void 0,function*(){if(this._state!==H.Ready)return new Promise((t,n)=>{let i;i=this.addListenerReturnDisposer(E.Connected,()=>{t(),i()})})})}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}log(t,n,i){!this.debug||this.logInternal(t,n||this.color)}warn(t){!this.debug||this.logInternal(t,"000",this.color)}error(t){this.logInternal(t,this.color,"f00")}logInternal(t,n,i){let r;typeof t=="string"?r=t:typeof t=="number"?r=t+"":r=JSON.stringify(t),n=n&&n+"",r=(this.id?`Metaframe[${this.id}] `:"")+`${r}`,Vt(r,n,i)}dispose(){super.removeAllListeners(),window.removeEventListener("message",this.onMessage),this.disableNotifyOnHashUrlChange(),this._inputPipeValues=void 0,this._outputPipeValues=void 0}addListener(t,n){return super.addListener(t,n),t===E.Inputs&&window.setTimeout(()=>{this._inputPipeValues&&n(this._inputPipeValues)},0),this}onInput(t,n){return this.addListenerReturnDisposer(E.Input,(i,r)=>{t===i&&n(r)})}onInputs(t){return this.addListenerReturnDisposer(E.Inputs,t)}setInput(t,n){var i={};i[t]=n,this.setInputs(i)}setInputs(t){this.sendRpc(k.InputsUpdate,t)}setInternalInputsAndNotify(t){!vt(this._inputPipeValues,t)||(Object.keys(t).forEach(n=>this.emit(E.Input,n,t[n])),this.emit(E.Inputs,t))}getInput(t){return console.assert(!!t),this._inputPipeValues[t]}getInputs(){return this._inputPipeValues}getOutput(t){return console.assert(!!t),this._outputPipeValues[t]}setOutput(t,n){console.assert(!!t);var i={};i[t]=n,this.setOutputs(i)}setOutputs(t){!vt(this._outputPipeValues,t)||this.sendRpc(k.OutputsUpdate,t)}getOutputs(){return this._outputPipeValues}disableNotifyOnHashUrlChange(){window.removeEventListener("hashchange",this._onHashUrlChange)}_onHashUrlChange(t){const n={hash:window.location.hash,metaframe:this.id};this.sendRpc(k.HashParamsUpdate,n)}sendRpc(t,n){if(this._isIframe){const i={jsonrpc:"2.0",id:++this._messageSendCount,method:t,params:n,iframeId:this.id,parentId:this._parentId};window.parent.postMessage(i,"*")}else this.log("Cannot send JSON-RPC window message: there is no window.parent which means we are not an iframe")}onMessage(t){if(typeof t.data=="object"){let i=t.data;if(i.jsonrpc==="2.0"){var n=i.method;if(!(n==T.SetupIframeServerResponse||i.parentId==this._parentId&&i.iframeId==this.id)){this.error(`window.message: received message but jsonrpc.parentId=${i.parentId} _parentId=${this._parentId} jsonrpc.iframeId=${i.iframeId} id=${this.id}`);return}switch(n){case T.SetupIframeServerResponse:this._resolveSetupIframeServerResponse(i.params);break;case T.InputsUpdate:if(this._state!==H.Ready)throw"Got InputsUpdate but metaframe is not MetaframeLoadingState.Ready";this.setInternalInputsAndNotify(i.params.inputs);break;case T.MessageAck:this.debug&&this.log(`ACK: ${JSON.stringify(i)}`);break;default:this.debug&&this.log(`window.message: unknown JSON-RPC method: ${JSON.stringify(i)}`);break}this.emit(E.Message,i)}}}}A.version=yi;A.ERROR=E.Error;A.CONNECTED=E.Connected;A.INPUT=E.Input;A.INPUTS=E.Inputs;A.MESSAGE=E.Message;class ji{constructor(t){this._metaframe=t,this.requestState=this.requestState.bind(this),this.onState=this.onState.bind(this),this.getState=this.getState.bind(this),this.setState=this.setState.bind(this),this.onDefinition=this.onDefinition.bind(this),this.getDefinition=this.getDefinition.bind(this),this.setDefinition=this.setDefinition.bind(this)}requestState(){var t={method:Nt.State};this._metaframe.sendRpc(k.PluginRequest,t)}onState(t){const n=this._metaframe.onInput(V,t);return this.getState()&&t(this.getState()),n}getState(){return this._metaframe.getInput(V)}setState(t){this._metaframe.setOutput(V,t)}onDefinition(t){var n=this._metaframe.onInput(L,t);return this.getDefinition()&&t(this.getDefinition()),n}setDefinition(t){this._metaframe.setOutput(L,t)}getDefinition(){return this._metaframe.getInput(L)}}const Wt=()=>Ui(window.location.href),Ui=e=>{let t=new URL(e).hash.substr(1);const n=t.indexOf("?");if(n===-1)return[t,{}];const i=t.substr(0,n);t=t.substr(n+1);const r=Object.fromEntries(t.split("&").filter(s=>s.length>0).map(s=>s.split("=")));return Object.keys(r).forEach(s=>r[s]=decodeURI(r[s])),[i,r]},Ni=(e,t,n)=>{const i=Wt()[1];let r=!1;if(i.hasOwnProperty(e)&&t===null||t===void 0?(delete i[e],r=!0):i[e]!==t&&(i[e]=t,r=!0),!r)return[];const s=Object.keys(i);s.sort();const o=s.map((l,c)=>`${l}=${encodeURI(i[l])}`).join("&");let h=window.location.hash.substr(1);const u=h.indexOf("?");let f="";u>-1&&(f=h.substr(0,u));const a=new URL(window.location.href);a.hash=`${f}?${o}`,(n==null?void 0:n.modifyHistory)?window.location.hash=`${f}?${o}`:(window.history.replaceState(null,document.title,`${a.pathname}${a.search}${a.hash}`),window.dispatchEvent(new HashChangeEvent("hashchange")))},Ti=(e,t)=>{const[n,i]=tt(Wt()[1][e]||t);et(()=>{const s=o=>{const h=Wt()[1];i(h[e])};return window.addEventListener("hashchange",s),()=>window.removeEventListener("hashchange",s)},[]);const r=$t((s,o)=>{Ni(e,s,o)},[]);return[n,r]},Gi=(e,t)=>{const[n,i]=Ti(e,t?`${t}`:void 0),[r,s]=tt(n==="true");et(()=>{s(n==="true")},[e,n,s]);const o=$t((h,u)=>{h==null||h===!1?i(void 0,u):i("true",u)},[i]);return[r,o]},Vi={inputs:{}},Hi={},un=ft(Hi);ft(Vi);const Ji=()=>we(un),zi=e=>{const[t,n]=tt({}),[i,r]=tt(void 0);return et(()=>{const s=new A;return r(s),()=>{s.dispose()}},[r]),et(()=>{i&&n({metaframe:i})},[i]),Gn.createElement(un.Provider,{value:t},e.children)};var Fi=zn(gn),Wi,hn=Fi,qi=0;function Bi(e,t,n,i,r){var s,o,h={};for(o in t)o=="ref"?s=t[o]:h[o]=t[o];var u={type:e,props:h,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--qi,__source:i,__self:r};if(typeof e=="function"&&(s=e.defaultProps))for(o in s)h[o]===void 0&&(h[o]=s[o]);return hn.options.vnode&&hn.options.vnode(u),u}Wi=Bi;export{Gi as A,zi as D,B as S,Ji as T,Wi as j,tt as l,et as y};
//# sourceMappingURL=vendor.b063ca2c.js.map
